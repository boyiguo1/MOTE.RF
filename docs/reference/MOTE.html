<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>MOTE — MOTE • MOTE.RF</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="MOTE — MOTE" />
<meta property="og:description" content="MOTE is a fast implementation of MOTE RF (Guo et al. 2021), a random forest model that simultaneously estimates individualized treatment effects of multivariate outcomes." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MOTE.RF</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Example.html">Example</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/boyiguo1/MOTE.RF/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>MOTE</h1>
    <small class="dont-index">Source: <a href='https://github.com/boyiguo1/MOTE.RF/blob/master/R/MOTE.R'><code>R/MOTE.R</code></a></small>
    <div class="hidden name"><code>MOTE.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>MOTE is a fast implementation of MOTE RF (Guo et al. 2021), a random forest model that simultaneously estimates individualized treatment effects of multivariate outcomes.</p>
    </div>

    <pre class="usage"><span class='fu'>MOTE</span><span class='op'>(</span>
  <span class='va'>x.b</span>,
  <span class='va'>x.e</span>,
  <span class='va'>treat</span>,
  <span class='va'>y.b</span>,
  <span class='va'>y.e</span>,
  <span class='va'>Z</span>,
  num.trees <span class='op'>=</span> <span class='fl'>300</span>,
  min.node.size <span class='op'>=</span> <span class='cn'>NULL</span>,
  max.depth <span class='op'>=</span> <span class='cn'>NULL</span>,
  num.random.splits <span class='op'>=</span> <span class='fl'>1</span>,
  minprop <span class='op'>=</span> <span class='fl'>0.1</span>,
  write.forest <span class='op'>=</span> <span class='cn'>TRUE</span>,
  replace <span class='op'>=</span> <span class='cn'>TRUE</span>,
  sample.fraction <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>replace</span>, <span class='fl'>1</span>, <span class='fl'>0.632</span><span class='op'>)</span>,
  class.weights <span class='op'>=</span> <span class='cn'>NULL</span>,
  keep.inbag <span class='op'>=</span> <span class='cn'>FALSE</span>,
  inbag <span class='op'>=</span> <span class='cn'>NULL</span>,
  holdout <span class='op'>=</span> <span class='cn'>FALSE</span>,
  oob.error <span class='op'>=</span> <span class='cn'>TRUE</span>,
  num.threads <span class='op'>=</span> <span class='fl'>1</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>,
  seed <span class='op'>=</span> <span class='cn'>NULL</span>,
  dependent.variable.name <span class='op'>=</span> <span class='cn'>NULL</span>,
  trt.variable.name <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>num.trees</th>
      <td><p>Number of trees.</p></td>
    </tr>
    <tr>
      <th>min.node.size</th>
      <td><p>Minimal node size. Default 1 for classification, 5 for regression, 3 for survival, and 10 for probability.</p></td>
    </tr>
    <tr>
      <th>max.depth</th>
      <td><p>Maximal tree depth. A value of NULL or 0 (the default) corresponds to unlimited depth, 1 to tree stumps (1 split per tree).</p></td>
    </tr>
    <tr>
      <th>num.random.splits</th>
      <td><p>For "extratrees" splitrule.: Number of random splits to consider for each candidate splitting variable.</p></td>
    </tr>
    <tr>
      <th>minprop</th>
      <td><p>For "maxstat" splitrule: Lower quantile of covariate distribution to be considered for splitting.</p></td>
    </tr>
    <tr>
      <th>write.forest</th>
      <td><p>Save <code>MOTE.forest</code> object, required for prediction. Set to <code>FALSE</code> to reduce memory usage if no prediction intended.</p></td>
    </tr>
    <tr>
      <th>replace</th>
      <td><p>Sample with replacement.</p></td>
    </tr>
    <tr>
      <th>sample.fraction</th>
      <td><p>Fraction of observations to sample. Default is 1 for sampling with replacement and 0.632 for sampling without replacement. For classification, this can be a vector of class-specific values.</p></td>
    </tr>
    <tr>
      <th>class.weights</th>
      <td><p>Weights for the outcome classes (in order of the factor levels) in the splitting rule (cost sensitive learning). Classification and probability prediction only. For classification the weights are also applied in the majority vote in terminal nodes.</p></td>
    </tr>
    <tr>
      <th>keep.inbag</th>
      <td><p>Save how often observations are in-bag in each tree.</p></td>
    </tr>
    <tr>
      <th>inbag</th>
      <td><p>Manually set observations per tree. List of size num.trees, containing inbag counts for each observation. Can be used for stratified sampling.</p></td>
    </tr>
    <tr>
      <th>holdout</th>
      <td><p>Hold-out mode. Hold-out all samples with case weight 0 and use these for variable importance and prediction error.</p></td>
    </tr>
    <tr>
      <th>oob.error</th>
      <td><p>Compute OOB prediction error. Set to <code>FALSE</code> to save computation time, e.g. for large survival forests.</p></td>
    </tr>
    <tr>
      <th>num.threads</th>
      <td><p>Number of threads. Default is number of CPUs available.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Show computation status and estimated runtime.</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>Random seed. Default is <code>NULL</code>, which generates the seed from <code>R</code>. Set to <code>0</code> to ignore the <code>R</code> seed.</p></td>
    </tr>
    <tr>
      <th>dependent.variable.name</th>
      <td><p>Name of dependent variable, needed if no formula given. For survival forests this is the time variable.</p></td>
    </tr>
    <tr>
      <th>trt.variable.name</th>
      <td><p>Name of treatment variable. Treatment variable should be a factor variable</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further arguments passed to or from other methods (currently ignored).</p></td>
    </tr>
    <tr>
      <th>formula</th>
      <td><p>Object of class <code>formula</code> or <code>character</code> describing the model to fit. Interaction terms supported only for numerical variables.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>Training data of class <code>data.frame</code>, <code>matrix</code>, <code>dgCMatrix</code> (Matrix).</p></td>
    </tr>
    <tr>
      <th>save.memory</th>
      <td><p>Use memory saving (but slower) splitting mode. No effect for survival and GWAS data. Warning: This option slows down the tree growing, use only if you encounter memory problems.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>Predictor data (independent variables), alternative interface to data with formula or dependent.variable.name.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>Response vector (dependent variable), alternative interface to data with formula or dependent.variable.name. For survival use a <code>Surv()</code> object or a matrix with time and status.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Object of class <code>ranger</code> with elements</p>
<dt><code>forest</code></dt><dd><p>Saved forest (If write.forest set to TRUE). Note that the variable IDs in the <code>split.varIDs</code> object do not necessarily represent the column number in R.</p></dd>
<dt><code>predictions</code></dt><dd><p>Predicted classes/values, based on out of bag samples (classification and regression only).</p></dd>
<dt><code>variable.importance</code></dt><dd><p>Variable importance for each independent variable.</p></dd>
<dt><code>prediction.error</code></dt><dd><p>Overall out of bag prediction error. For classification this is the fraction of missclassified samples, for probability estimation the Brier score, for regression the mean squared error and for survival one minus Harrell's C-index.</p></dd>
<dt><code>r.squared</code></dt><dd><p>R squared. Also called explained variance or coefficient of determination (regression only). Computed on out of bag data.</p></dd>
<dt><code>confusion.matrix</code></dt><dd><p>Contingency table for classes and predictions based on out of bag samples (classification only).</p></dd>
<dt><code>call</code></dt><dd><p>Function call.</p></dd>
<dt><code>num.trees</code></dt><dd><p>Number of trees.</p></dd>
<dt><code>num.independent.variables</code></dt><dd><p>Number of independent variables.</p></dd>
<dt><code>mtry</code></dt><dd><p>Value of mtry used.</p></dd>
<dt><code>min.node.size</code></dt><dd><p>Value of minimal node size used.</p></dd>
<dt><code>num.samples</code></dt><dd><p>Number of samples.</p></dd>
<dt><code>inbag.counts</code></dt><dd><p>Number of times the observations are in-bag in the trees.</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Forests of extremely randomized trees (Geurts et al. 2006) can be grown.</p>
<p>Note that:</p><ul>
<li><p>nodes with size smaller than <code>min.node.size</code> can occur, as in original Random Forests.</p></li>
<li><p>The mtry variable that randomly selected variables doesn't exist in our framework, as we are using oblique splitting rules.</p></li>
<li><p>For factor covriates, a reference coding design matrix will be created accordingly. TODO: it is possible to extend this later by extending to ordered factors.</p></li>
<li><p>The importance of variables/features are calculated by accumulating the coefficients in the oblique splitting rules weighted by node sample size.</p></li>
<li><p>The model yet to provide handling of missing value. Data containing missing value can promote computation error and warning.</p></li>
</ul>

<p>For a large number of variables and data frames as input data the formula interface can be slow or impossible to use.
TODO: need improve this part a little bit
Alternatively <code>dependent.variable.name</code> and <code>status.variable.name</code> for treatment category or <code>x</code> and <code>y</code> can be used.
Use <code>x</code> and <code>y</code> with a matrix for <code>x</code> to avoid conversions and save memory.</p>
<p>TODO:
Since our algorithm is oriented to analyze microbiome data, we can directly use phyloseq object.
Case weights is not supported temporarily</p>
<p>See <a href='https://github.com/boyiguo1/MOTE.RF'>https://github.com/boyiguo1/MOTE.RF</a> for the development version.</p>
<p>With recent R versions, multithreading on Windows platforms should just work.
If you compile yourself, the new RTools toolchain is required.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    
<ul>
<li><p>Guo et al. (Submitted). Estimating Heterogeneous Treatment Effect on Multivariate Responses using Random Forests. <a href='https://doi.org/xxxx'>https://doi.org/xxxx</a>.</p></li>
</ul>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='predict.MOTE.html'>predict.MOTE()</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Boyi Guo</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>

<span class='va'>p</span> <span class='op'>=</span> <span class='fl'>10</span>
<span class='va'>q</span> <span class='op'>=</span> <span class='fl'>3</span>

<span class='va'>B</span> <span class='op'>=</span> <span class='fu'><a href='create.B.html'>create.B</a></span><span class='op'>(</span><span class='va'>p</span><span class='op'>)</span>
<span class='va'>Z</span> <span class='op'>=</span> <span class='fu'><a href='create.Z.html'>create.Z</a></span><span class='op'>(</span><span class='va'>p</span>,<span class='va'>q</span><span class='op'>)</span>

<span class='va'>sim.dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='sim_MOTE_data.html'>sim_MOTE_data</a></span><span class='op'>(</span>B <span class='op'>=</span> <span class='va'>B</span>, Z <span class='op'>=</span> <span class='va'>Z</span><span class='op'>)</span>





</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Boyi Guo, Ruoqing Zhu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


